<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="audience:migration" name="primaryAudienceTag" /> 
  <meta content="products:SG_CAMPAIGN/CLASSIC" name="primaryProductTag" /> 
  <meta content="31bad53a-3d52-4dbb-8feb-feab670f8af5" name="jcr:predecessors" /> 
  <meta content="5756c0af-1654-47b3-869f-21bd17e7771c" name="jcr:uuid" /> 
  <meta content="Testing the migration" name="navTitle" /> 
  <meta content="sauviat" name="contentOwner" /> 
  <meta content="2019-07-18" name="publishExternalDate" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="products:SG_CAMPAIGN/CLASSIC;content_type:reference" name="cq:tags" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="Testing the migration" name="jcr:description" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="2019-08-06T06:59:37.119-0400" name="jcr:created" /> 
  <meta content="" name="seoDescription" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="light" name="heroGradient" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="Testing the migration" name="jcr:title" /> 
  <meta content="" name="jcr:primaryType" /> 
 </head> 
 <body> 
  <h2 id="general-procedure">General procedure</h2> 
  <p>Depending on your configuration, there are several ways of carrying out migration tests.</p> 
  <p>You should have a test/development environment to carry out migration tests. Development environments are subject to license: check your license contract or contact Adobe Campaign's sales service. </p> 
  <ol> 
   <li><p>Stop all developments in progress and carry them over to the production environment.</p> </li> 
   <li><p>Make a backup of the development environment database.</p> </li> 
   <li><p>Stop all Adobe Campaign processes on the development instance.</p> </li> 
   <li><p>Make a backup of the production environment database and restore it as a development environment.</p> </li> 
   <li><p>Before starting the Adobe Campaign services, run the <strong>freezeInstance.js</strong> cauterization script which lets you clear the database of any objects that were running when the backup was started.</p> 
    <codeblock gutter="true" class="syntax html">
      nlserver&amp;nbsp;javascript&amp;nbsp;nms:freezeInstance.js&amp;nbsp;-instance:&lt;instance&gt;&amp;nbsp;-arg:&lt;run|dry&gt; 
    </codeblock> 
    <note> 
     <p> The command launches by default in <strong>dry</strong> mode, and lists all the requests that were executed by that command, without launching them. To execute cauterization requests, use <strong>run</strong> in the command.<br /> </p> 
    </note></li> 
   <li><p>Make sure your backups are correct by trying to restore them. Make sure you can access your database, your tables, your data, etc.</p> </li> 
   <li><p>Test the migration procedure in the development environment.</p> <p>The full procedures are detailed in the <a href="../../migration/using/prerequisites-for-migration-to-adobe-campaign-7.md" target="_blank">Prerequisites for migration to Adobe Campaign 7</a> section.</p> </li> 
   <li><p>If the migration of the development environment is successful, you can migrate the production environment.</p> </li> 
  </ol> 
  <note>
    Due to changes made to the data structure, importing and exporting data packages is not possible between a v5 platform and a v7 platform. 
   <br /> 
  </note> 
  <note> 
   <p> The Adobe Campaign update command (<strong>postupgrade</strong>) lets you synchronize resources and update schemas and the database. This operation can only be carried out once and only on the application server. After synchronizing resources, the <strong>postupgrade</strong> command lets you detect whether the synchronization generates any errors or warnings.<br /> </p> 
  </note> 
  <h2 id="migration-tools">Migration tools</h2> 
  <p>Various options let you measure the impact from a migration and identify the potential problems. These options are to be executed:</p> 
  <ul> 
   <li><p>in the <strong>config</strong> command: </p> 
    <codeblock gutter="true" class="syntax html">
      nlserver.exe&amp;nbsp;config&amp;nbsp;&lt;option&gt;&amp;nbsp;-instance:&lt;instanceName&gt; 
    </codeblock></li> 
   <li><p>or at the postupgrade:</p> 
    <codeblock gutter="true" class="syntax html">
      nlserver.exe&amp;nbsp;config&amp;nbsp;-postupgrade&amp;nbsp;&lt;option&gt;&amp;nbsp;-instance:&lt;instanceName&gt; 
    </codeblock></li> 
  </ul> 
  <note> 
   <p> You must use the <strong>-instance: 
     <instancename /></strong> option. We do not recommend using the <strong>-allinstances</strong> option.<br /> </p> 
  </note> 
  <h3 id="-showcustomentities-and--showdeletedentities-options">-showCustomEntities and -showDeletedEntities options</h3> 
  <ul> 
   <li><p> The <strong>-showCustomEntities</strong> option displays the list of all non-standard objects:</p> 
    <codeblock gutter="true" class="syntax html">
      nlserver.exe&amp;nbsp;config&amp;nbsp;-showCustomEntities&amp;nbsp;-instance:&lt;instanceName&gt; 
    </codeblock><p>Example of a sent message:</p> 
    <codeblock gutter="true" class="syntax html">
      xtk_migration:opsecurity2&amp;nbsp;xtk:entity 
    </codeblock></li> 
   <li><p>The <strong>-showDeletedEntities</strong> option displays the list of all the standard objects that are missing in the database or the file system. For each missing object, the path is specified.</p> 
    <codeblock gutter="true" class="syntax html">
      nlserver.exe&amp;nbsp;config&amp;nbsp;-showDeletedEntities&amp;nbsp;-instance:&lt;instanceName&gt; 
    </codeblock><p>Example of a sent message:</p> 
    <codeblock gutter="true" class="syntax html">
      Out&amp;nbsp;of&amp;nbsp;the&amp;nbsp;box&amp;nbsp;object&amp;nbsp;'nms:deliveryCustomizationMdl'&amp;nbsp;belonging&amp;nbsp;to&amp;nbsp;the&amp;nbsp;'xtk:srcSchema'&amp;nbsp;schema&amp;nbsp;has&amp;nbsp;not&amp;nbsp;been&amp;nbsp;found&amp;nbsp;in&amp;nbsp;the&amp;nbsp;file&amp;nbsp;system. 
    </codeblock></li> 
  </ul> 
  <h3 id="verification-process">Verification process</h3> 
  <p>Integrated as standard in the postupgrade command, this process lets you display warnings and errors that could make the migration fail. <strong>If errors are displayed, the migration has not been executed.</strong> If this happens, correct all the errors then re-start the postupgrade.</p> 
  <p>You can start the verification process on its own (without migration) using the command:</p> 
  <codeblock gutter="true" class="syntax html">
    nlserver.exe&amp;nbsp;config&amp;nbsp;-postupgrade&amp;nbsp;-check&amp;nbsp;-instance:&lt;instanceName&gt; 
  </codeblock> 
  <p>The following expressions are searched for (case sensitive):</p> 
  <table> 
   <thead> 
    <tr> 
     <th> Expression<br /> </th> 
     <th> Error code<br /> </th> 
     <th> Log type<br /> </th> 
     <th> Comments<br /> </th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td> .@<br /> </td> 
     <td> PU-0001<br /> </td> 
     <td> Warning<br /> </td> 
     <td> This type of syntax is no longer supported in delivery personalization. Refer to <a href="../../migration/using/testing-the-migration.md#javascript" target="_blank">JavaScript</a>. Otherwise, check that the value type is correct.<br /> </td> 
    </tr> 
    <tr> 
     <td> common.js<br /> </td> 
     <td> PU-0002<br /> </td> 
     <td> Warning<br /> </td> 
     <td> This library must not be used.<br /> </td> 
    </tr> 
    <tr> 
     <td> logon(<br /> </td> 
     <td> PU-0003<br /> </td> 
     <td> Warning<br /> </td> 
     <td> This connection method must be no longer be used. Refer to <a href="../../migration/using/testing-the-migration.md#identified-web-applications" target="_blank">Identified web applications</a>.<br /> </td> 
    </tr> 
    <tr> 
     <td> new SoapMethodCall(<br /> </td> 
     <td> PU-0004<br /> </td> 
     <td> Warning<br /> </td> 
     <td> This function is only supported when it is used in JavaScript code executed from a security zone that is in <strong>sessionTokenOnly</strong> mode.<br /> </td> 
    </tr> 
    <tr> 
     <td> sql=<br /> </td> 
     <td> PU-0005<br /> </td> 
     <td> Error<br /> </td> 
     <td> This type of error leads to a migration failure. Refer to <a href="../../migration/using/testing-the-migration.md#sqldata" target="_blank">SQLData</a>.<br /> </td> 
    </tr> 
    <tr> 
     <td> SQLDATA<br /> </td> 
     <td> PU-0006<br /> </td> 
     <td> Error<br /> </td> 
     <td> This type of error leads to a migration failure. Refer to <a href="../../migration/using/testing-the-migration.md#sqldata" target="_blank">SQLData</a>. If you get overview-type web application error logs (migration from v6.02), refer to <a href="../../migration/using/testing-the-migration.md#web-applications" target="_blank">Web applications</a>.<br /> </td> 
    </tr> 
   </tbody> 
  </table> 
  <p>A database and schema coherence check is also carried out.</p> 
  <h3 id="restoration-option">Restoration option</h3> 
  <p>This option lets you restore out-of-the-box objects if they had been modified. For each restored object, a backup of your changes is stored in the selected folder:</p> 
  <codeblock gutter="true" class="syntax html">
    nlserver.exe&amp;nbsp;config&amp;nbsp;-postupgrade&amp;nbsp;-restoreFactory:&lt;backupfolder&gt;&amp;nbsp;-instance:&lt;instanceName&gt; 
  </codeblock> 
  <note> 
   <p> We strongly recommend using absolute folder paths and keeping the folder tree structure. For example: backupFoldernmssrcSchemabilling.xml. <br /> </p> 
  </note> 
  <h3 id="resuming-migration">Resuming migration</h3> 
  <p>If you restart the postupgrade after a migration failure, it resumes from the same place it was stopped.</p> 
 </body> 
</html>