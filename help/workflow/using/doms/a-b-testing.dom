<?xml version="1.1" encoding="UTF-8" standalone="yes"?> 
<html> 
 <head> 
  <meta content="audience:workflow" name="primaryAudienceTag" /> 
  <meta content="" name="seoDescription" /> 
  <meta content="" name="jcr:baseVersion" /> 
  <meta content="" name="jcr:primaryType" /> 
  <meta content="mix:versionable" name="jcr:mixinTypes" /> 
  <meta content="A/B testing" name="jcr:title" /> 
  <meta content="products:SG_CAMPAIGN/CLASSIC;content_type:reference" name="cq:tags" /> 
  <meta content="/apps/help/templates/article-3" name="cq:template" /> 
  <meta content="A/B testing" name="navTitle" /> 
  <meta content="true" name="jcr:isCheckedOut" /> 
  <meta content="/etc/designs/help" name="cq:designPath" /> 
  <meta content="products:SG_CAMPAIGN/CLASSIC" name="primaryProductTag" /> 
  <meta content="A/B testing" name="jcr:description" /> 
  <meta content="light" name="heroGradient" /> 
  <meta content="2019-08-06T06:59:17.762-0400" name="jcr:created" /> 
  <meta content="en_us" name="jcr:language" /> 
  <meta content="e5bd7ed2-caa7-4fc2-90c6-88ed030f7b24" name="jcr:uuid" /> 
  <meta content="admin" name="jcr:createdBy" /> 
  <meta content="sauviat" name="contentOwner" /> 
  <meta content="2019-07-18" name="publishExternalDate" /> 
  <meta content="" name="jcr:versionHistory" /> 
  <meta content="help/components/pages/article-3" name="sling:resourceType" /> 
  <meta content="11cfcf73-6bbb-4ae5-83e2-ae95c3eabcc7" name="jcr:predecessors" /> 
 </head> 
 <body> 
  <p>If you have several contents for an email delivery and you want to find out which version will have the biggest impact on the targeted population, you can send the different versions to some of your recipients, then select the one with the highest success rate and send it to the rest of your recipients. </p> 
  <p>In this use case, we are going to compare two email delivery contents via a targeting workflow. The message and the text are identical in both deliveries: only the layout changes.</p> 
  <p>The targeted population is divided into three: two test groups and the remaining population. A different version of the delivery is sent to each test group. After the delivery, a 5-day wait period is configured before collecting the results of the best open rates. The content of the delivery with the highest score is then recovered by a script and sent to the population that wasn't used as a test group. </p> 
  <p>Please note that the criteria that will decide which delivery is the best may be altered to meet your needs. It can be the open rate, the click-through rate, the subscription rate, reactivity, etc. </p> 
  <p>Moreover, the test detailed in this use case concerns only two deliveries, but you can test as many versions as necessary. Simply add activities to the workflow.</p> 
  <p>To create the A/B test, apply the following steps:</p> 
  <ul> 
   <li><p> <a href="../../workflow/using/a-b-testing.md#step-1--creating-a-targeting-workflow" target="_blank">Step 1: Creating a targeting workflow</a></p> </li> 
   <li><p> <a href="../../workflow/using/a-b-testing.md#step-2--configuring-population-samples" target="_blank">Step 2: Configuring population samples</a></p> </li> 
   <li><p> <a href="../../workflow/using/a-b-testing.md#step-3--creating-two-delivery-templates" target="_blank">Step 3: Creating two delivery templates</a></p> </li> 
   <li><p> <a href="../../workflow/using/a-b-testing.md#step-4--configuring-the-deliveries-in-the-workflow" target="_blank">Step 4: Configuring the deliveries in the workflow</a></p> </li> 
   <li><p> <a href="../../workflow/using/a-b-testing.md#step-5--creating-the-script" target="_blank">Step 5: Creating the script</a></p> </li> 
   <li><p> <a href="../../workflow/using/a-b-testing.md#step-7--starting-the-workflow" target="_blank">Step 7: Starting the workflow</a></p> </li> 
   <li><p> <a href="../../workflow/using/a-b-testing.md#step-8--analyzing-the-result" target="_blank">Step 8: Analyzing the result</a>.</p> </li> 
  </ul> 
  <h2 id="step-1--creating-a-targeting-workflow">Step 1: Creating a targeting workflow</h2> 
  <p>You need to create your workflow in the <strong>Targeting and Workflows</strong> tab of a campaign. It is made up of a <strong>Query</strong> activity, a <strong>Split</strong> activity linked to two <strong>Email delivery</strong> activities, a <strong>Wait</strong> activity, a <strong>JavaScript code</strong> activity, and a <strong>Delivery</strong> activity.</p> 
  <ol> 
   <li><p>If you haven't already done so, create a campaign (for more on this, refer to this <a href="../../campaign/using/setting-up-marketing-campaigns.md#creating-a-campaign">section</a>).</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_targetwkfl_001.png" title="use_case_abtesting_targetwkfl_001.png" /></li> 
   <li><p>Go to the <strong>Targeting and Workflows</strong> tab.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_targetwkfl_002.png" title="use_case_abtesting_targetwkfl_002.png" /></li> 
   <li><p>Change the label of the existing workflow or click <strong>Add</strong> to create a new one (for more on this, refer to this <a href="../../campaign/using/setting-up-marketing-campaigns.md#selecting-the-target-population">section</a>).</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_targetwkfl_003.png" title="use_case_abtesting_targetwkfl_003.png" /></li> 
   <li><p>Use the mouse to drag and drop activities into the workflow diagram, including a <strong>Query</strong> (<strong>Target</strong> tab), a <strong>Split</strong> (<strong>Target</strong> tab), two <strong>Email deliveries</strong> (<strong>Deliveries</strong> tab), a <strong>Wait</strong> activity (<strong>Flow Control</strong> tab), a <strong>JavaScript code</strong> activity (<strong>Actions</strong> tab), and a <strong>Delivery</strong> activity (<strong>Actions</strong> tab).</p> </li> 
  </ol> 
  <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_targetwkfl_004.png" title="use_case_abtesting_targetwkfl_004.png" /> 
  <h2 id="step-2--configuring-population-samples">Step 2: Configuring population samples</h2> 
  <h3 id="configuring-the-query-activity">Configuring the Query activity</h3> 
  <ul> 
   <li><p>Double-click the <strong>Query</strong> activity.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_001.png" title="use_case_abtesting_createrecipients_001.png" /></li> 
   <li><p>Click the <strong>Edit query</strong> link and select the recipients you want to target.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_002.png" title="use_case_abtesting_createrecipients_002.png" /></li> 
   <li><p>Link the <strong>Query</strong> activity to the <strong>Split</strong> activity.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_003.png" title="use_case_abtesting_createrecipients_003.png" /></li> 
  </ul> 
  <h3 id="configuring-the-split-activity">Configuring the Split activity</h3> 
  <p>This activity lets you create several populations: the one that receives delivery A, the one that receives delivery B, and the remaining population. Using random selection lets you target just part of the population of each delivery.</p> 
  <ol> 
   <li><p>Creating population A:</p> 
    <ul> 
     <li><p>Double-click the <strong>Split</strong> activity.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_004.png" title="use_case_abtesting_createrecipients_004.png" /></li> 
     <li><p>In the existing tab, change the label to population A.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_005.png" title="use_case_abtesting_createrecipients_005.png" /></li> 
     <li><p>Select the <strong>Limit the selected records</strong> option.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_006.png" title="use_case_abtesting_createrecipients_006.png" /></li> 
     <li><p>Click the <strong>Edit</strong> link, select <strong>Activate random sampling</strong>, and click <strong>Next</strong>.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_007.png" title="use_case_abtesting_createrecipients_007.png" /></li> 
     <li><p>Set the threshold to 10%, then click <strong>Finish</strong>.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_008.png" title="use_case_abtesting_createrecipients_008.png" /></li> 
    </ul></li> 
   <li><p>Creating population B:</p> 
    <ul> 
     <li><p>Click <strong>Add</strong> to create a new tab for population B.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_009.png" title="use_case_abtesting_createrecipients_009.png" /></li> 
     <li><p>Limit the population to 10% as previously.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_010.png" title="use_case_abtesting_createrecipients_010.png" /></li> 
    </ul></li> 
   <li><p>Creating the remaining population:</p> 
    <ul> 
     <li><p>Go to the <strong>General</strong> tab.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_011.png" title="use_case_abtesting_createrecipients_011.png" /></li> 
     <li><p>Select <strong>Generate complement</strong>.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_012.png" title="use_case_abtesting_createrecipients_012.png" /></li> 
     <li><p>Change the label to specify that this population includes neither A nor B, and click <strong>OK</strong> to close the activity.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createrecipients_013.png" title="use_case_abtesting_createrecipients_013.png" /></li> 
    </ul></li> 
  </ol> 
  <h2 id="step-3--creating-two-delivery-templates">Step 3: Creating two delivery templates</h2> 
  <p>We now want to create two delivery templates. Each template will be referenced in an <strong>Email delivery</strong> activity linked to the <strong>Split</strong> activity. For more on this, refer to this <a href="../../delivery/using/about-templates.md">section</a>.</p> 
  <ol> 
   <li><p>Go to the <strong>Resources &gt; Delivery template</strong> folder.</p> </li> 
   <li><p>Duplicate the <strong>Email</strong> delivery template.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_deliverymodel_001.png" title="use_case_abtesting_deliverymodel_001.png" /></li> 
   <li><p>Create the content to be used for delivery A.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_deliverymodel_002.png" title="use_case_abtesting_deliverymodel_002.png" /></li> 
   <li><p>Repeat this process to create a template for delivery B.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_deliverymodel_003.png" title="use_case_abtesting_deliverymodel_003.png" /></li> 
  </ol> 
  <h2 id="step-4--configuring-the-deliveries-in-the-workflow">Step 4: Configuring the deliveries in the workflow</h2> 
  <p>The next step is to configure the deliveries. They are destined for the three populations created during the previous stage: <a href="../../workflow/using/a-b-testing.md#step-2--configuring-population-samples" target="_blank">Step 2: Configuring population samples</a>. The first two deliveries enable you to send different contents to population A and B. The third delivery is destined for the population that received neither A nor B. Its content will be calculated by a script and will be identical to either A or B, depending on which one scored the highest open rate. We need to configure a wait period for the third delivery, to find out the outcome of deliveries A and B. This is why the third delivery includes a <strong>Wait</strong> activity.</p> 
  <ol> 
   <li><p>Go to the <strong>Split</strong> activity and link the transition destined for population A to one of the email deliveries already in the workflow.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createdeliveries_001.png" title="use_case_abtesting_createdeliveries_001.png" /></li> 
   <li><p>Double-click the delivery to open it.</p> </li> 
   <li><p>Using the drop-down list, select the template for delivery A.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createdeliveries_003.png" title="use_case_abtesting_createdeliveries_003.png" /></li> 
   <li><p>Click <strong>Continue</strong> to view the delivery, then save it.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createdeliveries_002.png" title="use_case_abtesting_createdeliveries_002.png" /></li> 
   <li><p>Link the transition of the <strong>Split</strong> activity destined for population B to the second email delivery.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createdeliveries_004.png" title="use_case_abtesting_createdeliveries_004.png" /></li> 
   <li><p>Open the delivery and select the template in delivery B, then save the delivery.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createdeliveries_005.png" title="use_case_abtesting_createdeliveries_005.png" /></li> 
   <li><p>Link the transition destined for the remaining population to the <strong>Wait</strong> activity.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createdeliveries_006.png" title="use_case_abtesting_createdeliveries_006.png" /></li> 
   <li><p>Open the <strong>Wait</strong> activity and configure a 5-day waiting period.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createdeliveries_007.png" title="use_case_abtesting_createdeliveries_007.png" /></li> 
   <li><p>Link the <strong>Wait</strong> activity to the <strong>JavaScript code</strong> activity.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_createdeliveries_008.png" title="use_case_abtesting_createdeliveries_008.png" /></li> 
  </ol> 
  <h2 id="step-5--creating-the-script">Step 5: Creating the script</h2> 
  <p>The choice of the delivery content destined for the remaining population is calculated by a script. This script recovers the information concerning the delivery with the highest rate of opens and copies the content into the final delivery.</p> 
  <h3 id="example-of-a-script">Example of a script</h3> 
  <p>The following script can be used as is in the targeting workflow. For more on this, refer to <a href="../../workflow/using/a-b-testing.md#implementation" target="_blank">Implementation</a>.</p> 
  <codeblock gutter="true" class="syntax html">
    &amp;nbsp;//&amp;nbsp;query&amp;nbsp;the&amp;nbsp;database&amp;nbsp;to&amp;nbsp;find&amp;nbsp;the&amp;nbsp;winner&amp;nbsp;(best&amp;nbsp;open&amp;nbsp;rate)!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;winner&amp;nbsp;=&amp;nbsp;xtk.queryDef.create(!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;queryDef&amp;nbsp;schema="nms:delivery"&amp;nbsp;operation="get"&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;select&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="@id"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="@label"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="[@operation-id]"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="[@workflow-id]"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/select&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;where&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;condition&amp;nbsp;expr={"@FCP=0&amp;nbsp;and&amp;nbsp;[@workflow-id]=&amp;nbsp;"&amp;nbsp;+&amp;nbsp;instance.id}/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/where&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;orderBy&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="[indicators/@estimatedRecipientOpenRatio]"&amp;nbsp;sortDesc="true"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/orderBy&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/queryDef&gt;).ExecuteQuery()!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;create&amp;nbsp;a&amp;nbsp;new&amp;nbsp;delivery&amp;nbsp;object&amp;nbsp;and&amp;nbsp;initialize&amp;nbsp;it&amp;nbsp;by&amp;nbsp;doing&amp;nbsp;a&amp;nbsp;copy&amp;nbsp;of!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;the&amp;nbsp;winner&amp;nbsp;delivery!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;delivery&amp;nbsp;=&amp;nbsp;nms.delivery.create()!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;delivery.Duplicate("nms:delivery|"&amp;nbsp;+&amp;nbsp;winner.@id)!!discoiqbr!!!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;append&amp;nbsp;'final'&amp;nbsp;to&amp;nbsp;the&amp;nbsp;delivery&amp;nbsp;label!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;delivery.label&amp;nbsp;=&amp;nbsp;winner.@label&amp;nbsp;+&amp;nbsp;"&amp;nbsp;final"!!discoiqbr!!!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;link&amp;nbsp;the&amp;nbsp;delivery&amp;nbsp;to&amp;nbsp;the&amp;nbsp;operation&amp;nbsp;to&amp;nbsp;make&amp;nbsp;sure&amp;nbsp;it&amp;nbsp;will&amp;nbsp;be&amp;nbsp;displayed&amp;nbsp;in!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;the&amp;nbsp;campaign&amp;nbsp;dashboard.&amp;nbsp;This&amp;nbsp;attribute&amp;nbsp;needs&amp;nbsp;to&amp;nbsp;be&amp;nbsp;set&amp;nbsp;manually&amp;nbsp;here&amp;nbsp;since&amp;nbsp;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;the&amp;nbsp;Duplicate()&amp;nbsp;method&amp;nbsp;has&amp;nbsp;reset&amp;nbsp;it&amp;nbsp;to&amp;nbsp;its&amp;nbsp;default&amp;nbsp;value&amp;nbsp;=&gt;&amp;nbsp;0!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;delivery.operation_id&amp;nbsp;=&amp;nbsp;winner.@["operation-id"]!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;delivery.workflow_id&amp;nbsp;=&amp;nbsp;winner.@["workflow-id"]!!discoiqbr!!!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;adjust&amp;nbsp;some&amp;nbsp;delivery&amp;nbsp;parameters&amp;nbsp;to&amp;nbsp;make&amp;nbsp;it&amp;nbsp;compatible&amp;nbsp;with&amp;nbsp;the&amp;nbsp;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;"Prepare&amp;nbsp;and&amp;nbsp;start"&amp;nbsp;option&amp;nbsp;selected&amp;nbsp;in&amp;nbsp;the&amp;nbsp;Delivery&amp;nbsp;tab&amp;nbsp;of&amp;nbsp;this&amp;nbsp;activity!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;delivery.scheduling.validationMode&amp;nbsp;=&amp;nbsp;"manual"!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;delivery.scheduling.delayed&amp;nbsp;=&amp;nbsp;0!!discoiqbr!!&amp;nbsp;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;save&amp;nbsp;the&amp;nbsp;delivery&amp;nbsp;in&amp;nbsp;database!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;delivery.save()!!discoiqbr!!&amp;nbsp;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;//&amp;nbsp;store&amp;nbsp;the&amp;nbsp;new&amp;nbsp;delivery&amp;nbsp;Id&amp;nbsp;in&amp;nbsp;event&amp;nbsp;variables!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;vars.deliveryId&amp;nbsp;=&amp;nbsp;delivery.id!!discoiqbr!! 
  </codeblock> 
  <p>For a detailed explanation of the script, refer to <a href="../../workflow/using/a-b-testing.md#details-of-the-script" target="_blank">Details of the script</a>.</p> 
  <h3 id="implementation">Implementation</h3> 
  <ol> 
   <li><p>Open your <strong>JavaScript code</strong> activity.</p> </li> 
   <li><p>Copy the script offered in <a href="../../workflow/using/a-b-testing.md#example-of-a-script" target="_blank">Example of a script</a> into the <strong>JavaScript code</strong> window.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_configscript_002.png" title="use_case_abtesting_configscript_002.png" /></li> 
   <li><p>In the <strong>Label</strong> field, enter the name of the script, i.e. </p> 
    <codeblock gutter="true" class="syntax html">
      &lt;%=&amp;nbsp;vars.deliveryId&amp;nbsp;%&gt; 
    </codeblock><img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_configscript_003.png" title="use_case_abtesting_configscript_003.png" /></li> 
   <li><p>Close the <strong>JavaScript code</strong> activity.</p> </li> 
   <li><p>Save your workflow.</p> </li> 
  </ol> 
  <h3 id="details-of-the-script">Details of the script</h3> 
  <p>This section details the various parts of the script and their operating mode.</p> 
  <ul> 
   <li><p>The first part of the script is a query. The <strong>queryDef</strong> command lets you recover from the <strong>NmsDelivery</strong> table the deliveries created by executing the targeting workflow and to sort them based on their estimated rate of opens, then the information from the delivery with the highest rate of opens is recovered.</p> 
    <codeblock gutter="true" class="syntax html">
      //&amp;nbsp;query&amp;nbsp;the&amp;nbsp;database&amp;nbsp;to&amp;nbsp;find&amp;nbsp;the&amp;nbsp;winner&amp;nbsp;(best&amp;nbsp;open&amp;nbsp;rate)!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;var&amp;nbsp;winner&amp;nbsp;=&amp;nbsp;xtk.queryDef.create(!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;queryDef&amp;nbsp;schema="nms:delivery"&amp;nbsp;operation="get"&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;select&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="@id"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="@label"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="[@operation-id]"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/select&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;where&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;condition&amp;nbsp;expr={"@FCP=0&amp;nbsp;and&amp;nbsp;[@workflow-id]=&amp;nbsp;"&amp;nbsp;+&amp;nbsp;instance.id}/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/where&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;orderBy&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;node&amp;nbsp;expr="[indicators/@estimatedRecipientOpenRatio]"&amp;nbsp;sortDesc="true"/&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/orderBy&gt;!!discoiqbr!!&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/queryDef&gt;).ExecuteQuery() 
    </codeblock></li> 
   <li><p>The delivery with the highest rate of opens is duplicated.</p> 
    <codeblock gutter="true" class="syntax html">
      &amp;nbsp;//&amp;nbsp;create&amp;nbsp;a&amp;nbsp;new&amp;nbsp;delivery&amp;nbsp;object&amp;nbsp;and&amp;nbsp;initialize&amp;nbsp;it&amp;nbsp;by&amp;nbsp;doing&amp;nbsp;a&amp;nbsp;copy&amp;nbsp;of!!discoiqbr!!&amp;nbsp;//&amp;nbsp;the&amp;nbsp;winner&amp;nbsp;delivery!!discoiqbr!!var&amp;nbsp;delivery&amp;nbsp;=&amp;nbsp;nms.delivery.create()!!discoiqbr!!delivery.Duplicate("nms:delivery|"&amp;nbsp;+&amp;nbsp;winner.@id) 
    </codeblock></li> 
   <li><p>The label of the duplicated delivery is modified, and the word <strong>final</strong> is added to it.</p> 
    <codeblock gutter="true" class="syntax html">
      //&amp;nbsp;append&amp;nbsp;'final'&amp;nbsp;to&amp;nbsp;the&amp;nbsp;delivery&amp;nbsp;label!!discoiqbr!!delivery.label&amp;nbsp;=&amp;nbsp;winner.@label&amp;nbsp;+&amp;nbsp;"&amp;nbsp;final" 
    </codeblock></li> 
   <li><p>The delivery is copied into the campaign dashboard.</p> 
    <codeblock gutter="true" class="syntax html">
      //&amp;nbsp;link&amp;nbsp;the&amp;nbsp;delivery&amp;nbsp;to&amp;nbsp;the&amp;nbsp;operation&amp;nbsp;to&amp;nbsp;make&amp;nbsp;sure&amp;nbsp;it&amp;nbsp;will&amp;nbsp;be&amp;nbsp;displayed&amp;nbsp;in!!discoiqbr!!//&amp;nbsp;the&amp;nbsp;campaign&amp;nbsp;dashboard.&amp;nbsp;This&amp;nbsp;attribute&amp;nbsp;needs&amp;nbsp;to&amp;nbsp;be&amp;nbsp;set&amp;nbsp;manually&amp;nbsp;here&amp;nbsp;since&amp;nbsp;!!discoiqbr!!//&amp;nbsp;the&amp;nbsp;Duplicate()&amp;nbsp;method&amp;nbsp;has&amp;nbsp;reset&amp;nbsp;it&amp;nbsp;to&amp;nbsp;its&amp;nbsp;default&amp;nbsp;value&amp;nbsp;=&gt;&amp;nbsp;0!!discoiqbr!!delivery.operation_id&amp;nbsp;=&amp;nbsp;winner.@["operation-id"]!!discoiqbr!!delivery.workflow_id&amp;nbsp;=&amp;nbsp;winner.@["workflow-id"] 
    </codeblock></li> 
   <li> 
    <codeblock gutter="true" class="syntax html">
      //&amp;nbsp;adjust&amp;nbsp;some&amp;nbsp;delivery&amp;nbsp;parameters&amp;nbsp;to&amp;nbsp;make&amp;nbsp;it&amp;nbsp;compatible&amp;nbsp;with&amp;nbsp;the&amp;nbsp;!!discoiqbr!!//&amp;nbsp;"Prepare&amp;nbsp;and&amp;nbsp;start"&amp;nbsp;option&amp;nbsp;selected&amp;nbsp;in&amp;nbsp;the&amp;nbsp;Delivery&amp;nbsp;tab&amp;nbsp;of&amp;nbsp;this&amp;nbsp;activity!!discoiqbr!!delivery.scheduling.validationMode&amp;nbsp;=&amp;nbsp;"manual"!!discoiqbr!!delivery.scheduling.delayed&amp;nbsp;=&amp;nbsp;0 
    </codeblock></li> 
   <li><p>The delivery is saved in the database.</p> 
    <codeblock gutter="true" class="syntax html">
      //&amp;nbsp;save&amp;nbsp;the&amp;nbsp;delivery&amp;nbsp;in&amp;nbsp;database!!discoiqbr!!delivery.save() 
    </codeblock></li> 
   <li><p>The unique identifier of the duplicated delivery is stored in the workflow variable.</p> 
    <codeblock gutter="true" class="syntax html">
      //&amp;nbsp;store&amp;nbsp;the&amp;nbsp;new&amp;nbsp;delivery&amp;nbsp;Id&amp;nbsp;in&amp;nbsp;event&amp;nbsp;variables!!discoiqbr!!vars.deliveryId&amp;nbsp;=&amp;nbsp;delivery.id 
    </codeblock></li> 
  </ul> 
  <h3 id="other-selection-criteria">Other selection criteria</h3> 
  <p>The example above lets you select the content of a delivery based on the rate of opens of emails. You can adapt it to base yourself on other delivery-specific indicators:</p> 
  <ul> 
   <li><p>Best click throughput: [indicators/@recipientClickRatio],</p> </li> 
   <li><p> Highest reactivity rate (email open and clicks in the message): [indicators/@reactivity],</p> </li> 
   <li><p>Lowest complaint rate: [indicators/@refusedRatio] (use the false value for the sortDesc attribute),</p> </li> 
   <li><p>Highest conversion rate: [indicators/@transactionRatio],</p> </li> 
   <li><p>Number of pages visited following the reception of a message: [indicators/@totalWebPage],</p> </li> 
   <li><p>Lowest unsubscription rate: [indicators/@optOutRatio],</p> </li> 
   <li><p>Transaction amount: [indicators/@amount].</p> </li> 
  </ul> 
  <h2 id="step-6--defining-the-final-delivery">Step 6: Defining the final delivery</h2> 
  <p>Once the script is created to select the A/B test winner, you can define the parameters of the final delivery.</p> 
  <ol> 
   <li><p>Connect the <strong>JavaScript code</strong> activity to the remaining <strong>Delivery</strong> activity.</p> </li> 
   <li><p>Open the <strong>Delivery</strong> activity.</p> </li> 
   <li><p>Uncheck the <strong>Generate an outbound transition</strong> option to finish the workflow with this activity.</p> </li> 
   <li><p>Leave the other options to their default values. </p> <img alt="" captionBottom="" imageRotate="0" src="assets/ab_test_final_delivery.png" title="ab_test_final_delivery.png" /></li> 
  </ol> 
  <p>By preparing the delivery specified in the transition (defined via the <strong>Javascript Code </strong>activity), you will be then able to approve it and to start the sending, as described in the next step.</p> 
  <h2 id="step-7--starting-the-workflow">Step 7: Starting the workflow</h2> 
  <ol> 
   <li><p>Click <strong>Start</strong> the workflow.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_startwkfl_001.png" title="use_case_abtesting_startwkfl_001.png" /></li> 
   <li><p>Approve target and content for deliveries A and B via the campaign dashboard.</p> </li> 
   <li><p>Confirm delivery.</p> </li> 
   <li><p>Wait until the end of the 5-day period to find out which content was calculated after delivery opening results.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_startwkfl_002.png" title="use_case_abtesting_startwkfl_002.png" /><p>In this case, template B was chosen.</p> </li> 
   <li><p>Once the content of the third delivery is determined, approve the target and the content.</p> </li> 
  </ol> 
  <h2 id="step-8--analyzing-the-result">Step 8: Analyzing the result</h2> 
  <p>Once the test deliveries have been sent, you can check which recipient(s) they have been sent to and whether or not they were opened.</p> 
  <ul> 
   <li><p>To find out which recipients have been targeted, open a delivery via the campaign dashboard and click the <strong>Delivery</strong> tab.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_analysis_001.png" title="use_case_abtesting_analysis_001.png" /></li> 
   <li><p>To find out whether the delivery has been opened, go to the <strong>Tracking</strong> tab.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_analysis_002.png" title="use_case_abtesting_analysis_002.png" /></li> 
   <li><p>Compare with the other delivery.</p> <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_analysis_003.png" title="use_case_abtesting_analysis_003.png" /></li> 
  </ul> 
  <p>In our example, delivery B has scored the highest open rate. This means that content B will be used for the final delivery.</p> 
  <img alt="" captionBottom="" imageRotate="0" src="assets/use_case_abtesting_analysis_004.png" title="use_case_abtesting_analysis_004.png" /> 
 </body> 
</html>